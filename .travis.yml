sudo: required

addons:
  apt:
    sources:
      - debian-sid    # Grab shellcheck from the Debian repo (o_O)
    packages:
      - shellcheck

services:
  - docker

env:
  - DOCKER_RELEASE="1.10.3" KUBERNETES_RELEASE="v1.1.8"
  - DOCKER_RELEASE="1.10.3" KUBERNETES_RELEASE="v1.2.0-beta.1"

install:
  - sudo service docker stop
  - sudo curl --silent --location https://get.docker.com/builds/Linux/x86_64/docker-${DOCKER_RELEASE} --output /usr/bin/docker
  - sudo chmod +x /usr/bin/docker
  - sudo service docker start

script:
  - shellcheck -s bash ./build-and-push ./docker-images/toolbox-configure.sh ./docker-images/toolbox/scripts/*
  - shellcheck -s sh docker-images/etcd-anywhere.sh docker-images/weave-fix-nameserver.sh
  - shellcheck -s bash docker-images/apiserver-anywhere.sh docker-images/controller-manager-anywhere.sh docker-images/kubelet-anywhere.sh docker-images/proxy-anywhere.sh docker-images/scheduler-anywhere.sh
  - env NO_PUSH=1 ./build-and-push
