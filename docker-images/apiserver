FROM gcr.io/google_containers/hyperkube:v1.1.2
LABEL works.weave.role=system

ENV CLOUD_PROVIDER="vagrant"
ENV ETCD_CLUSTER="http://etcd:2379"

CMD weave_ip=$(hostname -i) ; \
    /hyperkube apiserver \
      --insecure-bind-address=$weave_ip \
      --advertise-address=$weave_ip \
      --external-hostname=kube-apiserver.weave.local \
      --port=8080 \
      --etcd-servers=$ETCD_CLUSTER \
      --service-cluster-ip-range=10.16.0.0/12 \
      --cloud-provider=$CLOUD_PROVIDER \
      --logtostderr=true
