FROM centos:7
LABEL works.weave.role=system

ENV DOCKER_HOST=unix:///weave.sock

RUN curl --silent \
  https://storage.googleapis.com/kubernetes-release/release/v1.0.7/bin/linux/amd64/kubectl \
  --output /usr/bin/kubelet \
  && chmod +x /usr/bin/kubectl

RUN kubectl config set-cluster main-cluster --server=http://kube-apiserver.weave.local:8080 --api-version=v1

ADD skydns-addon /skydns-addon

RUN curl --silent \
  https://github.com/docker/compose/releases/download/1.5.0/docker-compose-Linux-x86_64 \
  --output /usr/bin/compose \
  && chmod +x /usr/bin/compose

ADD docker-compose.yaml /
